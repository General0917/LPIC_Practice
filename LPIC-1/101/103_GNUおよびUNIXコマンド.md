## chapter1

## 1-1
- シェル変数の一覧を表示するには、**set**コマンドラインを使用する
  - シェル変数
    - 設定されたシェルだけが使用する変数である
    - 子プロセスには引き継がれない
  - 環境変数
    - 設定されたシェルとそのシェルで起動したプログラムが使用する変数である
    - 子プロセスに引き継がれる
    - **export**コマンドにより定義(作成)する

  - setコマンド
    - 現在のシェルで定義されているシェル変数の一覧を表示する
    - 引数なしで実行する
    - シェル変数の値を定義するには、「シェル変数名=値」とする
    - 値の参照には、「$シェル変数名(または、${シェル変数名})」とする
    - シェル変数の削除にはunsetコマンドを使用する

  - 主なシェル変数
    | 変数名 | 説明 |
    | ---- | ---- |
    | PWD | カレントディレクトリの絶対パス |
    | PATH | コマンド検索パス |
    | HOME | ユーザーのホームディレクトリ |
    | PS1 | プロンプトを定義 |
    | PS2 | 2次プロンプトを定義 |
    | HISTFILE | コマンド履歴を格納するファイルを定義 |
    | LANG | 言語情報 |

### 1-2
- 現在の作業ディレクトリを表示するコマンドは、**echo ${PWD}**と、**PWD**である
  - 1-1の問題を参照する
  - echo
    - コマンドラインに変数を出力する
    - echo ${PWD}を実行すると、作業ディレクトリが表示される

### 1-3
- 現在のシェルに、パラメータやオプションを設定するコマンドは、**set**コマンドである
  - 1-1の問題を参照する
  - setコマンド
    - オプションを指定せずに実行すると、シェル変数、シェル関数を一覧表示する
    - オプションを指定すると、シェルのパラメータなどを設定可能
  - 主なオプション
    | オプション | 説明 |
    | ---- | ---- |
    | -o シェルオプション | シェルオプションを有効にする |
    | +o シェルオプション | シェルオプションを無効にする |

  - 主なシェルオプション
    | シェルオプション | 説明 |
    | ---- | ---- |
    | noclobber(-C) | リダイレクション(>)による既存のファイルへの上書きを禁止する |
    | histexpand(-H) | 「!番号」による履歴参照を行う(デフォルトで有効) |

## 1-4
- exportコマンドの目的として適切なものは、**シェル変数を環境変数に設定し、bashから起動するアプリケーションが参照できるようにする**である
  - exportコマンド
    - 環境変数を設定できる
    - 環境変数は子プロセスとして起動したアプリケーションに引き継がれるので、アプリケーションから利用できる

## 1-5
- bashシェルを使用している場合、次の設定(PS1='[\u@\h \w]')の意味で適切なものは、**bashシェルのコマンドプロンプトを設定している**である
  - bash
    - シェル変数PS1はコマンドプロンプト、シェル変数PS2は2次プロンプトとして定義されている
    - 2次プロンプトは、まだコマンドラインが完了せず、継続行であることを表す
    - CentOSでは、PS1のデフォルト値は「'\s-\v\$'」、PS2のデフォルト値は「'>'」である
  - プロンプト定義で使える表記
    | 主な表記 | 説明 |
    | ---- | ---- |
    | \s | シェルの名前 |
    | \v | bashのバージョン |
    | \u | ユーザー名 |
    | \h | ホスト名のうちの最初の . まで |
    | \w | 現在の作業ディレクトリ |

## 1-6
- 「cd ~yuko」コマンドを実行した際に適切なものは、**ユーザーyukoのホームディレクトリに移動する**である
  - cdコマンド
    - ファイルシステム内を移動する際に使用されるコマンド
  - ディレクトリに関する特殊記号
    | 記号 | 読み方 | 説明 | 
    | ---- | ---- | ---- |
    | / | スラッシュ | ルートディレクトリ。ファイルシステムの頂点(ルート)を表す |
    | ~ | チルダ | ホームディレクトリ。実行ユーザーの作業用ディレクトリを表す | 
    | . | ドット | カレントディレクトリ。実行ユーザーが作業を行っているディレクトリを表す |
    | .. | ドットドット | 親ディレクトリ。あるディレクトリを起点として、1つ上の階層にあるディレクトリを表す |

## 1-7
- manコマンドが実行時に参照するドキュメントファイルの置かれている場所として適切なものは、**/usr/share/man**と、**/usr/local/share/man**である
  - manコマンド
    - 引数で指定したコマンドのオンラインマニュアルを表示する
    - manコマンドの構文
      - man [オプション] [セクション] コマンドまたはキーワード
      - 主なオプション
        | オプション | 説明 |
        | ---- | ---- |
        | -f(--whatis) | キーワードと完全に一致するマニュアルが何セクションにあるか表示する |
        | -k(--apropos) | キーワードを含むマニュアルが何セクションにあるか表示する |
      - スクロール操作
        - マニュアルページが1画面で表示できない場合、manコマンドは1画面分を表示したところで一度表示を停止する
        - スクロール操作には次のキーを使用する
      - キー操作
        | 主なキー操作 | 説明 |
        | ---- | ---- |
        | Space | 次のページを表示 |
        | Enter | 次の行を表示 |
        | b | 前のページを表示 |
        | h | ヘルプを表示 |
        | q | manコマンドの終了 |
        | /文字列 | 指定した文字列で検索(nキーで次の検索) |

## 1-8
- あるコマンドの第1セクションのマニュアルを表示するコマンドとして適切なものは、**man 1 command**である
  - 1-7の問題を参照する

## 1-9
- コマンドの実行履歴が保存されているファイルとして適切なものは、**~/.bash_history**である
  - .bash_historyファイル
    - コマンド実行履歴の保存先は、デフォルトで「**~/.bash_history**」が使用される
    - bashのシェル変数HISTFILEのデフォルト値は「**~/.bash_history**」である
  - historyコマンド
    - コマンドの実行履歴を表示するコマンド
    - 引数を指定しない場合は、保存されている履歴をすべて表示するが、引数に履歴数を指定することで新しい履歴から指定された数の履歴を表示する
    - historyコマンドの構文
      - history [オプション] [履歴数]
      - 主なオプション
        | オプション | 説明 |
        | ---- | ---- |
        | -c | そのシェルの実行履歴を消去する |
        | -d [履歴番号] | 指定した履歴番号のコマンドをそのシェルの履歴から消去する |
      - キー操作
        | 主なキー操作 | 説明 |
        | ---- | ---- |
        | ↑(上矢印キー) | 一つ前のコマンドを表示する |
        | ↓(下矢印キー) | 一つ後のコマンドを表示する |
        | !! | 直前に実行したコマンドを表示する |
        | ![履歴番号] | 指定された履歴番号のコマンドを実行する |
        | ![文字列] | 指定した文字列から始まる直近のコマンドを実行する |

## 1-10
- あなたは現在、一般ユーザーであるyukoとしてシステムにログインしている。しかし都合により、現在のシェルを終了することなくrootの権限と環境でログインしなおす必要がある。適切なものは、**su - root**である
  - suコマンド
    - 一時的に他のユーザーの権限に切り替える場合に**su**コマンドを利用する
    - 「**su -**」の場合でも、rootユーザーにログインする
    - コマンドの構文
      - su [オプション] [変更先ユーザー名]
  - sudoコマンド
    - 事前に管理者から許可されている管理用コマンドを実行する

## 1-11
- ユーザーyukoは自分のホームディレクトリ下にdir_b/subdirを作成したいが、dir_bは存在していません。dir_b/subdirを作るために適切なものは、**mkdir -p /home/yuko/dir_b/subdir**である
  - mkdirコマンド
    - ディレクトリを作成する
    - コマンドの引数に複数のディレクトリ名を指定すると、一度に複数のディレクトリを作成することができる
    - コマンド引数に、**-p**を指定すると、パス途中のディレクトリも作成することができる
    - コマンドの構文
      - mkdir [オプション] ディレクトリ名...n
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -m [アクセス権] | 明示的にアクセス権を指定してディレクトリを作成する |
      | -p | 引数に階層のあるディレクトリを指定した場合、存在しない中間ディレクトリも同時に作成する |

## 1-12
- /tmp/A ディレクトリの中にあるすべてのファイル・サブディレクトリをカレントディレクトリに移動させたい場合、適切なものは、mv -f /tmp/A/*.である
  - mvコマンド
    - ファイルやディレクトリの移動に使用されるコマンド
    - mvコマンドの最後の引数に指定されたディレクトリに移動元のファイル(またディレクトリ)が同じ名前で移動する
    - コマンドの構文
      - mv [オプション] 移動元ファイル名...n ディレクトリ名
      - mv [オプション] 移動元ディレクトリ...n ディレクトリ名
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -i | 移動元に同名ファイルが存在する場合、上書きするか確認する |
      | -f | 移動元に同名ファイルが存在しても、強制的に上書きする |
    - 主なワイルドカード
      | 記号 | 説明 |
      | ---- | ---- |
      | ? | 任意の1文字 |
      | * | 0文字以上の文字列 |
      | [...] | []内に含まれる任意の1文字 |
      | [!...] | []内に含まれない任意の1文字 |
    - チルダ --- ホームディレクトリの省略表現
      | 記号 | 説明 |
      | ---- | ---- |
      | ~ | ホームディレクトリ。実行ユーザーの作業用ディレクトリを表す |
    - ダラー --- 置換
      | 記号 | 説明 |
      | ---- | ---- |
      | $ | 変数の置換(変数を参照して値に置換)や、コマンドの置換(ヒストリを参照した置換)などを行う |
    - クォート --- 特定の文字列をリテラルとして使用
      | 記号 | 説明 |
      | ---- | ---- |
      | '(シングルクォート) | 強いクォート(変数が展開されず、文字列として認識される) |
      | "(ダブルクォート) | 弱いクォート(変数が展開され、変数として認識される) |
      | ` | コマンド置換(シングルクォート内で、バッククォートが展開されていたら、文字列として認識される。また、ダブルクォート内で、バッククォートが展開されていたら、変数として展開される) |

## 1-13
- /usr/local/sampleディレクトリ内にあるすべてのファイル・サブディレクトリを/home/yuko/sampleディレクトリの下にコピーしたい場合、適切なものは、「cp -Rf /usr/local/samples/* /home/yuko/samples」である
  - cpコマンド
    - ファイルやディレクトリを複製する場合は、cpコマンドを使用する
    - 同じディレクトリ内や他のディレクトリに複製でき、他のディレクトリに複製する場合は同じ名前にすることもできる
    - cpコマンドは、ディレクトリのコピーを行う場合は、**-R**(もしくは、**-r**)オプションが必要である
    - コマンド構文
      - cp [オプション] コピー元ファイル名 コピー先ファイル名
      - cp [オプション] コピー元ファイル名...n コピー先ディレクトリ名
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -i | コピー先に同名ファイルが存在する場合、上書きするか確認する |
      | -f | コピー先に同名ファイルが存在しても、強制的に上書きする |
      | -p | コピー元の所有者、タイムスタンプ、アクセス権などの情報を保持したままコピーする |
      | -r(-R) | コピー元のディレクトリ階層をそのままコピーする |

  - lsコマンド
    - ファイルやディレクトリの情報を一覧表示する
    - コマンド構文
      - ls [オプション] [ディレクトリ名]...n
      - ls [オプション] [ファイル名]...n
    - ディレクトリを指定しない場合は、カレントディレクトリの内容が一覧で表示される
    - また通常ファイルを指定した場合は、そのファイル自身の名前や情報が表示される
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -F | ファイルタイプを表す記号の表示(/はディレクトリ、*は実行可能ファイル、@はシンボリックリンク) |
      | -a | 隠しファイル(ファイル名がドット「.」で始まるファイル)の表示 |
      | -A | 「-a」と同じ。ただし、カレントディレクトリ「.」と親ディレクトリ「..」は表示しない |
      | -l | 詳細な情報を含めて表示 |
      | -i | inode番号を付けて表示 |
      | -d | ディレクトリの内容ではなく、ディレクトリ自身の情報の表示 |
      | -R | サブディレクトリの内容を再帰的に表示 |

## 1-14
- /tmpディレクトリの下にあるサブディレクトリをすべて削除するために、適切なものは、**「rm -rf /tmp/*」**である
  - rmコマンド
    - ファイルとディレクトリの削除が可能
    - 問題文では、/tmpのサブディレクトリ以下をすべて削除するとの指示があるため、-r(もしくは-R)オプションが必要である
    - また、複数のファイル名を指定することで一度に指定したファイルすべてを削除すること可能
    - コマンド構文
      - rm [オプション] ファイル名...n
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -i | ファイルを削除する前にユーザーへ確認する |
      | -f | ユーザーへの確認なしに削除する |
      | -r(-R) | 指定されたディレクトリ内にファイル、ディレクトリが存在していてもすべて削除する |
    - 空のディレクトリを削除するコマンドとして、**rmdir**コマンドが利用できる

## 1-15
- 圧縮されたtarファイルであるfile.tar.gzに格納されているファイル名の一覧を表示するために、適切なものは、**tar ztf file.tar.gz**である
  - tarコマンド
    - アーカイブファイルの管理に使用されるコマンド
    - オプションによって指定したファイルをアーカイブしたり、アーカイブファイルからファイルの情報を表示したり、ファイルを取り出したりする
    - コマンド構文
      - tar [オプション] ファイル名またはディレクトリ名...n
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -c(--create) | アーカイブファイルを作成する |
      | -t(--list) | アーカイブファイルの内容の一覧を表示する |
      | -x(--extract, --get) | アーカイブファイルを展開する(アーカイブからファイルを抽出する) |
      | -f(--file=アーカイブ名) | アーカイブファイル名を指定する |
      | -v(--verbose) | 詳細情報を表示する |
      | -j(--bzip2) | アーカイブに対して、bzip2を使用する(アーカイブをbzip2形式で圧縮する) |
      | -J(--xz) | アーカイブ対して、xzを使用する(アーカイブをxz形式で圧縮する) |
      | -z(--gzip) | アーカイブに対して、gzipを使用する(アーカイブをgzip形式で圧縮する) |
    - オプションを指定する際にハイフンを省略することが可能
    - コマンド構文
      - gzipでの圧縮：gzip [オプション] ファイル名
      - gzipでの解凍：gunzip [オプション] ファイル名
        | オプション | 説明 |
        | ---- | ---- |
        | -d | 圧縮ファイルの展開 |
        | -c | 元ファイルを残して標準出力に出力 |
        | -r | ディレクトリ内のすべてのファイルを再帰的にそれぞれ圧縮 |
      - bzip2での圧縮：bzip2 [オプション] ファイル名
        | オプション | 説明 |
        | ---- | ---- |
        | -d | 圧縮ファイルの展開 |
        | -c | 元ファイルを残して標準出力に出力 |
      - bzip2での解凍：bunzip2 [オプション] ファイル名
      - xzでの圧縮：xz [オプション] ファイル名
        - 主なオプション
          | オプション | 説明 |
          | ---- | ---- |
          | -d(--decompress) | 圧縮ファイルの展開 |
          | -k(--keep) | 圧縮、展開処理後に元のファイルを削除しない |
          | -l(--list) | 圧縮ファイルの情報を表示する |
      - xzでの解凍：unxz [オプション] ファイル名
    - アーカイブ関連のコマンドとしてcpioやddといったコマンドもある
    - cpioはtarと同様に複数のファイルやディレクトリを1つにまとめる際に使用される
    - ddコマンドはファイルシステムやディスク単位でバックアップする際に利用される

## 1-16
- カレントディレクトリにあるsamples.tgzには、a.txtとb.txtファイルが格納されている。「gunzip sample.tgz」と実行した際に、カレントディレクトリにあるファイルは、**samples.tar**である
  - 問題文のファイルは、「samples.tgz」となっているので、tar形式でアーカイブされ、gzipで圧縮されていると考えられる
  - また、「gunzip samples.tgz」を実行すると記載されており、解凍はされるが、展開はされない
  - ファイルの拡張子からどの圧縮形式なのか判断できるため、z(gzip)、j(bzip2)、J(xz)は省略可能

## 1-17
- 表示が1画面に入りきらない場合に、1画面ずつ表示するコマンドとして適切なものは、**more**である
  - moreコマンド
    - 1画面に収まらないファイルを制御することが可能
    - コマンド構文
      - more ファイル
  - lessコマンド
    - 1画面に収まらないファイルを表示するコマンドとしてlessコマンドがある
    - オンラインマニュアルは、lessコマンドを使用しているため操作方法はオンラインマニュアルと同じである
    - コマンド構文
      - less ファイル
  - catコマンド
    - 表示したいファイルのファイル名を引数に指定するとディスプレイに表示される
    - 複数のファイルを指定すると、すべてのファイルが連続して表示される
    - また、-nオプションを使用すると出力結果に行番号が振られる
    - catコマンドは引数を指定しないと標準入力(キーボード)からデータを読み取る
    - キーボードから1行入力すると、それを単にディスプレイに表示し、[Ctrl] + [d]が押されるまで繰り返す
    - コマンド構文
      - cat [オプション] [ファイル名]...n
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -n | 行番号を表示する |
      | -b | 空白行を飛ばして行番号を表示する |
      | -A | 非表示文字を表示する |
      | -s | 連続した空白行を1行にする |
      | -E | 各行の最後に"$"を付加する |
  - 標準入力、標準出力、標準エラー出力
    - 各プロセス生成時に標準で用意されるデータの入口と出口である
    - Linuxでの入出力制御には、標準入力、標準出力、標準エラー出力の概念を利用する
    - 入出力制御
      | 用語 | 説明 |
      | ---- | ---- |
      | 標準入力(stdin) | コマンドが入力を受け付ける標準の入力元は、キーボードに設定されている |
      | 標準出力(stdout) | コマンドの標準の出力先は、ディスプレイに設定されている |
      | 標準エラー出力(stderr) | コマンドのエラーメッセージは、通常の出力とは区別されるが、通常は標準出力と同様にディスプレイに出力される |
  - nlコマンド
    - ファイルの内容に行番号をつけて表示する
    - catコマンドに-nオプションを使用すると行番号を付けて出力することができる
    - ただし、空行が含まれている場合にはnlコマンドと振る舞いが異なる
    - 「cat -n」では、空行も含めてすべての行に行番号を付けるが、nlでは、空行を除いた行に行番号を付ける
    - コマンド構文
      - nl [オプション] ファイル名
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -b a | 行番号を表示する |
      | -b t | 空白行を飛ばして行番号を表示する(nlコマンドのデフォルトで表示される) |

## 1-18
- ファイルタイプを確認するコマンドとして適切なものは、**file**である
  - fileコマンド
    - ファイルの種類を調べるにはfileコマンドを使用する
    - コマンド構文
      - file [オプション] ファイル名 | ディレクトリ名
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -i | MIMEタイプで表示する |
      | -f(--files-from リスト) | 検査するファイルの名前をリストファイルから読み込む |
      | -L(--dereference) | シンボリックリンクの参照先を調べる |
      | -z(--uncompress) | 圧縮ファイルの中も検査する |
      | -b(--brief) | 出力行の最初にファイル名を表示しない |
      | -N(--no-pad) | 出力を整列するためのファイル名への空白の追加を行わない |

## 1-19
- bashを使用している場合に、コマンドの後で"1>$2"と指定した場合の説明として、適切なものは、**標準出力(stdout)を標準エラー出力(stderr)にリダイレクトする**である
  - 問題文の"1>&2"で使用された1や2という整数は、ファイル記述子である
  - ファイル記述子は**0番は標準入力**、**1番は標準出力**、**2番は標準エラー出力**を表す
  - この0番、1番、2番はプロセスが生成されたときに用意される
  - プレセスが他にファイルをオープンすると、3番、4番、5番…と順にファイル記述子が使用される
  - もし標準出力はディスプレイに、標準エラー出力はファイルへ出力するように切り替えたい場合は、リダイレクションを使用する
  - リダイレクションは入出力先の切り替えが可能であり、「<」や「>」などのメタキャラクタを使用する
  - 問題文の"1>&2"とは、1番(標準出力)を2番(標準エラー出力)にリダイレクションするという意味になる
  - 標準出力、標準エラー出力のリダイレクト例をいくつか記載する
    - カレントディレクトリのファイルリストをfile1に格納する
      - `$ ls > file1`
    - 1>を使用してファイルリストをfile2に格納する
      - `$ ls 1> file2`
    - file1に、/binのファイルリストを追記して保存する
      - `$ ls /bin >> file1`
    - lsコマンドを実行してエラーが出力された場合のみfile3ファイルに格納する
      - `$ ls 存在しないファイル 存在するファイル 2> file3`
    - 標準出力、標準エラー出力の両方をbothファイルに格納する
      - `$ ls 存在しないファイル 存在するファイル $> both`
      - `$ ls 存在しないファイル 存在するファイル >$ both`
      - `$ ls 存在しないファイル 存在するファイル 1> both 2>&1`
    - コマンド1を実行した結果の標準出力、標準エラー出力の両方をbothファイルに格納する
      - `$ コマンド1 &> both`
      - `$ コマンド1 >$ both`
  - 標準入力のリダイレクト例をいくつか記載する
    - file1の内容を標準入力からコマンド1に取り込む
      - `$ コマンド1 < file1`
    - file1の内容を標準入力からコマンド1に取り込み、コマンド1の標準出力をコマンド2の標準入力に渡す
      - `$ コマンド1 < file1 | コマンド2`
      - 上記の例では、パイプ(|)を使用することで、コマンドの処理結果(標準出力)を次のコマンドの標準入力に渡してさらにデータを加工することができる
  
## 1-20
- コマンド「cmd 1> data」を実行した場合の説明で正しいものは、**コマンドcmdの標準出力をdataに格納する**である
  - 1-19の問題を参照する

## 1-21
- カレントディレクトリにfileAがない場合に、ls > fileAと実行した際の説明として適切なものは、**fileAが新規に作成され、lsの標準出力結果が書き込まれる**である
  - 1-19の問題を参照する

## 1-22
- 以下のように3行の長文をcatコマンドへの標準入力として取り込んで画面に表示する。空欄に入れる2文字の記号を記述するのは、**<<**である。
  ```
  $ cat << END
  > Free Software is a matter of liberty, not price.
  END
  ```
  - 「<<」は、ヒアドキュメントと呼び、主にシェルスクリプトの中で利用される
  - 実行例のように、コマンドの後ろに「<<文字列」を指定すると、指定した文字列が現れるまでの内容を、コマンドへの標準入力として扱う

## 1-23
- あるプログラムの実行結果である標準出力、標準エラー出力のどちらもあらゆる端末、ファイル、デバイスに表示させないようにする際に、そのプログラムのコマンドラインの最後の部分として適切なものは、**> /dev/null 2>&1**である
  - /dev/nullファイル
    - 特殊なデバイスファイル
    - このファイルに書かれたものはすべて消去され、このファイルを読み込むと常にEOF(End Of File)が返る

## 1-24
- コマンドの標準出力を別のコマンドにリダイレクトすると同時にファイルにも格納することのできるコマンドは、**tee**コマンドである
  - teeコマンド
    - 標準入力から読み込んだデータを標準出力とファイルの両方に出力する
    - コマンド構文
      - tee [オプション] ファイル名
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -a | ファイルに上書きせず、追記する |

## 1-25
- コマンドcmd1を実行後、コマンドcmd2を実行する際、適切なものは、**cmd1 ; cmd2**である。cmd1の実行結果を無視するものとする
  - コマンドを連続実行する際に、「;」、「&&」、「||」を使用する
  - 連続実行例
    - コマンド1、コマンド2を順々に実行する
      - `$ コマンド1 ; コマンド2`
    - コマンド1が実行できれば、次のコマンド2を実行する
      - `$ コマンド1 && コマンド2`
    - コマンド1が実行できなければ、次のコマンド2を実行する
      - `$ コマンド1 || コマンド2`
  - 実行したコマンドが成功した場合、終了ステータスの値は0となる
  - また、成功しなかった場合は、終了ステータスの値は0以外の数値となる
  - 終了ステータスの値は、「echo $?」で確認できる

## 1-26
- file1から文字列fooを大文字/小文字を区別せずに検索するコマンドラインとして、適切なものは、**cat file1 | grep -i foo**である
  - grepコマンド
    - テキストデータ内の文字列検索を行う
    - コマンドの構文
      - grep [オプション] 検索する文字列パターン [ファイル名]...n
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -c(--count) | マッチした行の行数のみ表示 |
      | -f(--file=ファイル) | 検索パターンをファイルから読み込む |
      | -i(--ignore-case) | 大文字、小文字を区別しない |
      | -n(--line-number) | 先頭に行番号を付けて、マッチした行を表示 |
      | -v(	--invert-match) | パターンに一致しない行を表示 |
      | -l(--files-with-matches) | パターンと一致するファイル名を表示 |
      | -E(--extended-regexp) | 検索に拡張正規表現を使う(egrepコマンドと同様) |
      | -F | 検索パターンを正規表現ではなく、固定文字列とする(fgrepコマンドと同様) |

## 1-27
- ファイルの先頭から、任意の行数を指定して、その内容を表示するコマンドは、**head**である
  - headコマンド
    - テキストファイルの先頭部分を表示する
    - 行数をオプションで指定しなければ、デフォルトで10行目まで表示する
    - -nオプションで行数を指定することで、先頭からn行目までを表示する
    - コマンドの構文
      - head [オプション] [ファイル名]...n
  - tailコマンド
    - テキストファイルの末尾部分を表示する
    - 行数をオプションで指定しなければ、デフォルトで10行目まで表示する
  - 主なオプション
    | オプション | 説明 |
    | ---- | ---- |
    | -n 行数 | -行数 | 行数を数字で指定。末尾のn行部分を表示 |
    | -c　バイト数 | 指定したバイト数をファイルの先頭から表示 |
    | -f | ファイルの内容が増え続けているものと仮定し、常にファイルの最終部分を読み続けようとする |
    - -fオプションはログファイルのモニタなどに有効である

## 1-28
- ファイルfileAの中の小文字をすべて大文字に変換して表示するコマンドラインとして、適切なものは、**tr a-z A-Z < fileA**である
  - trコマンド
    - 標準入力であるキーボードから入力した文字を指定した文字に変換して、標準出力であるディスプレイに表示することができる
    - コマンド構文
      - tr [オプション] [文字群1 [文字群2]]
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -d | 文字群1で合致した文字を削除する |
      | -s | 文字群1で合致した文字の繰り返しを1文字に置き換える |
    - 文字群の指定にはあらかじめ定義されている文字クラスを利用することも可能
      - 文字クラス
        | 文字クラス | 説明 |
        | ---- | ---- |
        | [:alnum:] | 英文字と数字 |
        | [:alpha:] | 英文字 |
        | [:digit:] | 数字 |
        | [:lower:] | 英小文字 |
        | [:space:] | 水平および垂直方向の空白 |
        | [:upper:] | 英大文字 |

## 1-29
- WindowsのNTFSファイルシステムで、1行目が「A」、2行目が「B」のsample.txtファイルを作成した。このファイルをLinuxのEXT4ファイルシステムに転送して「od -c sample.txt」を実行したところ、次のように表示された。ファイル中に含まれているLinuxのテキストファイルでは不要である「\r」を削除するには、**「tr -d '\r' < sample.txt > sample-new.txt」コマンドを実行する**である
  ```
  $ od -c sample.txt
  0000000 A \r \n B \r \n
  ```
  - 改行コードはOSごとに異なる。LinuxおよびWindowsの場合は以下のとおりである。
    | OS | 改行コード | エスケープ文字での表示 | 
    | ---- | ---- | ---- |
    | Linux | LF | \n |
    | Windows | CR+LF | \r\n |

## 1-30
- ファイルfileAの中のbobという文字列をすべてBobという文字列に変換して表示するコマンドラインとして、適切なものは、**sed 's/bob/Bob/g fileA'**である
  - sedコマンド
    - 単語単位の変換や削除の際に使用される
    - 入力ストリーム(ファイルまたはパイプラインからの入力)に対してテキスト変換を行うために用いられます
    - コマンド構文
      - sed [オプション] [編集コマンド] [ファイル名]
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -i | 編集結果を直接ファイルに書き込む |
    - 主なコマンド
      | オプション | 説明 |
      | ---- | ---- |
      | s/パターン/置換文字列/ | 各行を対象に、最初のパターンに合致する文字列を置換文字列に変換する |
      | s/パターン/置換文字列/g | ファイル内全体を対象に、パターンに合致する文字列を置換文字列に変換する |
      | d | パターンに合致する行を削除 |
      | p | パターンに合致する行を表示 |
    - その他の利用例
      - file5の1行目を削除
        - `$ sed '1d' file5`
      - file5の2行目から5行目を削除
        - `$ sed 2,5d file5`
      - file5の空白行を削除
        - `$ sed '/^$/d file5'`
      - file5の行末にtestを追加1
        - `$ sed 's/$/ test/' file5`
      - file5のuser01が含まれる行だけ表示
        - `$ sed -n '/user01/p' file5`

## 1-31
- /etc/passwdファイルにあるユーザー名とログインシェルを表示するコマンドとして適切なものは、**cut -d : -f 1,7 /etc/passwd**である
  - cutコマンド
    - ファイル内の行中の特定部分のみ取り出す
    - /etc/passwdの1行目(ユーザー名)と7行目(ログインシェル)を取り出す際のコマンド処理
    - コマンドの構文
      - cut [オプション] ファイル名
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -c(--characters=出力リスト) | 指定された位置の各文字だけを表示する |
      | -b(--bytes=出力リスト) | 指定された位置の各バイトだけを表示する |
      | -d(--delimiter=文字) | -fと一緒に用い、フィールドの区切り文字を指定。デフォルトはタブ |
      | -f(--fields=出力リスト) | 指定された各フィールドだけを表示する |
      | -s(	--only-delimited) | -fと一緒に用い、フィールドの区切り文字を含まない行を表示しない |
    - その他の利用例
      - file5のフィールドの区切り文字を空白として、2番目のフィールドを取り出す
        - `$ cut -d ' ' -f 2 file5`
      - file5のフィールドの区切り文字を空白として、1番目と3番目のフィールドを取り出す
        - `$ cut -d ' ' -f 1,3 file5`
      - file5の1文字目から3文字までを取り出す
        - `$ cut -c 1,3 file5`
      - 「ps ax」の表示行の先頭5文字(プロセスID)を取り出す
        - `$ ps ax | cut -c 1-5`

## 1-32
- OSに登録されているユーザー数を表示するコマンドラインとして、適切なものは、**wc -l etc/passwd**と、**cat /etc/passwd | wc -l**である
  - wcコマンド
    - ファイル内のバイト数、単語数、行数を表示する
    - -lオプションを使用することで、行数のみを表示することが可能
    - コマンドの構文
      - wc [オプション] [ファイル名]
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -c(--bytes) | バイト数だけを出力する |
      | -m(--chars) | 文字数を出力する(マルチバイト文字に対応) |
      | -l(--lines) | 行数だけを出力する |
      | -w(--words) | 単語数だけを出力する |
      | -L(--max-line-length) | 最も長い行の長さを表示する |

## 1-33
- ファイルの内容を8進数表示するコマンドは、**od**である
  - odコマンド
    - ファイルの内容を8進数やその他の形式で表示する
    - バイナリファイルの内容を表示する場合や、テキストファイルに含まれる非印字コードを調べるときなどに使用する
    - コマンドの構文
      - od [オプション] [ファイル名]
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -d | Decimal(10進数)で表示する |
      | -o | 8進数で表示する(デフォルト) |
      | -x | Hexa Decimal(16進数)で表示する |
      | -t | 出力フォーマットを指定 |
      | -c | ANCII文字またはバックスラッシュ付きのエスケープ文字として表示する |
      | -A 基数(--address-radix=指定) | ファイルオフセット（出力位置）の表示形式を「o（8進数）」「x（16進数）」「d（10進数）」で指定する |

## 1-34
- ファイルの読み込み、指定されたチャンク(塊)に分割するコマンドとして適切なものは、**split**である
  - splitコマンド
    - ファイルを決まった大きさに分割する
    - デフォルトでは、入力元ファイルを1000行ずつ分割し出力ファイルに書き込む
    - 分割後のファイルは、指定がなければxが使用され、接尾辞はaa、ab...が付与される
    - コマンドの構文
      - split [オプション] [入力元ファイル名 [プレフィックス]]
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -l | 出力の行数を指定する |
      | -d | サフィックスを英字(aa、ab...)ではなく数字(00、01...)にする |
    - またテキスト処理を行う以下のような便利なコマンドがある
      - ファイルの内容を行単位でソート
        - sort [オプション] [ファイル名]
          - 主なオプション
            | オプション | 説明 |
            | ---- | ---- |
            | -b | 行頭の空白を無視 |
            | -f | 大文字、小文字を区別しない |
            | -r | 降順でソート |
            | -t 区切り文字 | 指定した文字を区切り文字としてフィールドを認識 |
            | -n | 数字を文字でなく数値としてソート |
            | -k フィールド | ソート対象とするフィールドを指定(デフォルトは1つ目のフィールド) |
      - 並び替え済みのファイルから重複した行を削除する
        - uniq [オプション] [並び替え済みのファイル名]
          - 主なオプション
            | オプション | 説明 |
            | ---- | ---- |
            | -d | 重複している行のみを表示 |
            | -u | 重複していない行のみを表示 |
      - 2つのファイルを読み、フィールドか共通な行を結合する
        - join [オプション] [ファイル名1] [ファイル名2]
      - ファイルを行単位で結合する
        - paste [オプション] [ファイル名]

## 1-35
- Webからダウンロードしたファイルに対し、データの同一性を確認するため、データのハッシュ値を計算することができるコマンドは、**checkhash**である
  - 主なハッシュアルゴリズム
    | ハッシュアルゴリズム | 説明 |
    | ---- | ---- |
    | md5 | Message Digest Algorithm 5。128ビットのハッシュ値を出力する |
    | sha256 | Secure Hash Algorithm 256。NISTで定められた標準ハッシュ関数。256ビットで出力する |
    | sha512 | Secure Hash Algorithm 512。NISTで定められた標準ハッシュ関数。512ビットで出力する |
  - 主なオプション
    | オプション | 説明 |
    | ---- | ---- |
    | -c(--check) | オプションで読み込んだファイルの値と照合する |
    
## chapter3

### 3-1
- システムでアクティブなプロセスをすべて表示するコマンドラインは、**ps ax**と**ps -ef**、**pstree**である
  - プロセス
    - 実行中のプログラムのことである
    - 主なプロセスを表示するコマンド
      | 主なコマンド | 説明 |
      | ---- | ---- |
      | ps | プロセスの情報を表示する基本的なコマンド |
      | pstree | プロセスの階層情報を表示する |
      | top | プロセスの情報を周期的にリアルタイムに表示する |

    - 主なオプション
      | 種類 | 主なオプション | 説明 | 
      | ---- | ---- | ---- |
      | UNIX | -e | 全てのプロセスを表示する |
      |  | -f | 詳細情報(完全なフォーマットでプロセス)を表示する | 
      |  | -l | 長いフォーマットで詳細情報を表示する |
      |  | -o | ユーザー定義のフォーマットで表示する |
      | BSD | a | 全てのプロセス(他のユーザーのプロセス)を表示する |
      |  | f | プロセスの親子関係をツリー状で表示する |
      |  | l | プロセスのnice値を表示する |
      |  | u | 詳細情報(プロセスの実行ユーザー名)を表示する |
      |  | x | 制御端末のないプロセス情報も表示する |

    - psコマンドを使用した際の主な表示項目
      | 主な項目 | 説明 |
      | ---- | ---- |
      | PID | プロセスID |
      | TTY | 制御している端末 |
      | TIME | 実行時間 |
      | CMD | コマンド(実行ファイル名) |

### 3-2
- 現在のシェルで実行中のプロセスの優先度を確認するためのコマンドラインとして、適切なものは、**ps -l**と**top**である
  - プロセスの優先度
    - プロセスの優先度は、**NI(nice)値**で表す

### 3-3
- オプションを指定せずにプロセスをツリー構造で表示するコマンドは、**pstree**である
  - 3-1の問題を参照する
  - pstreeコマンドでの主なオプション
    | オプション | 説明 |
    | ---- | ---- |
    | -h | カレントのプロセスとその先祖プロセスを強調表示 |
    | -H PID | 指定したプロセスとその先祖プロセスを強調表示 |
    | -p | プロセスをIDを付けて表示 |

### 3-4
- initのプロセスIDとして適切なものは、**1**である
  - 基本プロセス(処理)が開始されるときは、数字の**1**から開始される

### 3-5
- プロセスのプライオリティ(優先度)をデフォルトから変更するコマンドは、**nice**である
  - 優先度は、**動的優先度**と**静的優先度**がある
    | 優先度 | 説明 |
    | ---- | ---- |
    | 動的優先度 | 静的優先度とCPU使用時間を基に計算され、CPUを使うほど優先度は低くなる。カーネル内部で100 ~ 139の範囲の値を持つ |
    | 静的優先度 | nice値により一定範囲でユーザーが設定可能。カーネル内部で100 ~ 139の範囲の値を持つ |
    
  - niceコマンドの主なオプション
    | オプション | 説明 |
    | ---- | ---- |
    | -c(--adjustment) 優先度 | 優先度(-20 ~ 19)を指定する |

  - niceの設定仕様
    - nice値は、**-20 ~ 19**の値で変更可能
    - niceコマンドで、オプションで数値を指定しない場合のnice値は**10(0 + 10)**の優先度を付与する

### 3-6
- プロセスのプライオリティ(優先度)を変更する場合、設定可能な最大値は、**19**である
  - 3-5の問題を参照する

### 3-7
- 実行中のプロセスの優先度を変更するコマンドとして適切なものは、**top**と**renice**である
  - reniceコマンドの主なオプション
    | オプション | 説明 |
    | ---- | ---- |
    | -n 優先度 | 優先度(nice値)を指定する |
    | -p プロセスID | 対象のプロセスIDを指定する |
    | -g グループID | 対象プロセスのグループIDを指定する |
    | -u ユーザー | 対象プロセスのユーザーIDまたはユーザー名を指定する |
    
  - reniceコマンドの構文
    - renice [オプション] nice値 オプション 

  - topでの優先度変更方法
    - ➀topコマンドを実行後プロセス情報が表示されたら、キーボードから[r]キーをタイプする
    - ➁画面に「PID to renice:」が表示されるので、変更したいプロセスのPID(プロセスID)を入力し[Enter]を押下する
    - ➂画面に「Renice PID [指定したPID] to value:」が表示されるため、優先度を入力し[Enter]を押下する

### 3-8
- バックグラウンドで動作しているジョブをフォアグラウンドで動かすコマンドとして適切なものは、**fg**である
  - ジョブ
    - コマンドライン1行で実行された処理単位のことである
    - ジョブはシェルごとに管理され、「ジョブID」が振られる
    - 1行のコマンドラインで複数のコマンドが実行された場合でも、その処理全体を1つのジョブとして扱う
    - ジョブの種類は、**フォアグラウンドジョブ**と**バックグラウンドジョブ**の2種類がある
      | ジョブ | 説明 |
      | ---- | ---- |
      | フォアグラウンドジョブ | キーボードと端末情報を占有して対話的な操作をするジョブ。そのジョブが終了するまで端末画面上には次のプロンプトが表示されない。シェルごとに1つのみ |
      | バックグラウンドジョブ | キーボード入力を受け取ることができないジョブ。画面への出力設定によっては抑制される。複数のジョブを同時に実行することが可能。**バックグラウンドでジョブ(コマンド)を実行する際には、コマンドの末尾に「&」を付ける。** |
    - ジョブを制御する主なコマンド
      | コマンド | 説明 |
      | ---- | ---- |
      | jobs | バックグラウンドジョブと一時停止中のジョブを表示 |
      | Ctrl + z | 実行しているジョブを一時停止にする |
      | bg %ジョブID | 指定したジョブをバックグラウンドに移行 |
      | fg %ジョブID | 指定したジョブをフォアグラウンドに移行 |

### 3-9
以下のような実行例がある
```
$ myapp
[1] + 停止 myapp
$
```
- ユーザーからのコマンド入力を可能にしたままで、停止しているmyappを再開させるコマンドラインとして適切なものは、**bg myapp**である
  - 3-8の問題を参照する

### 3-10
- 現在バックグラウンドで走っているジョブをすべて表示するコマンドは、**jobs**である
  - 3-8の問題を参照する

### 3-11
- ログアウトした後もコマンドが終了することなく、バックグラウンドで実行を続けさせるコマンドラインとして適切なものは、**nohup コマンド名 &**である。
  - nohupコマンド
    - ログアウトしてもプログラムを実行し続けるには、**nohup**コマンドを使用する
    - 標準出力と標準エラー出力は、カレントディレクトリに「nohup.out」というファイル名でリダイレクトする
    - 書き込めない場合は、ホームディレクトリへ「nohup.out」というファイル名でリダイレクトする
    - コマンドの構文
      - nohup コマンド [引数]

### 3-12
- 「kill プロセスID」を実行したときにプロセスに送られるシグナルとして適切なものは、**SIGTERM(15)**である
  - シグナル
    - 割り込みによってプロセスに特定の動作をするように通知するための仕組みである
    - 通常、プロセスは処理を終えると自動的に消滅するが、プロセスに対してシグナルを送信することで外部からプロセスを終了することができる
    - シグナルは、キーボードによる操作や「kill コマンド」の実行などにより、実行中のプロセスに送信される
    - 主なシグナル
      | シグナル番号 | シグナル名 | 説明 | 
      | ---- | ---- | ---- |
      | 1 | SIGHUP | 端末の切断によるプロセスの終了 |
      | 2 | SIGINT | 割り込みによるプロセスの終了([Ctrl] + [c]で使用) | 
      | 9 | SIGKILL | プロセスの強制終了 |
      | 15 | SIGTERM | プロセスの終了(デフォルト)(killコマンドを実行した際に送られる) |
      | 18 | SIGCONT | 一時停止したプロセスを再開する |
      | 19 | SIGSTOP | 一時停止 |
      | 20 | SIGTSTP | 端末から入力された一時停止([Ctrl] + [z]で使用) |

    - killコマンド
      - 指定したプロセスIDのプロセスを終了させる
      - 主なオプション
        | オプション | 説明 |
        | ---- | ---- |
        | -s | 	指定したシグナル名またはシグナル番号を送信する |
        | -シグナル | 指定したシグナル名またはシグナル番号を送信する |
        | -l [] | シグナル名とシグナル番号の対応を表示する |
      - シグナルの送信には、killコマンドの他、**killall**コマンドも使用可能
      - コマンドの構文
        - kill [オプション] [シグナル名 | シグナル番号] プロセスID
        - kill [オプション] [シグナル名 | シグナル番号] %ジョブID
        - killall [オプション] [シグナル名 | シグナル番号] プロセス名

### 3-13
- 「kill 1234」と同じ動きをするコマンドラインとして適切なものは、**「kill -15 1234」**と、**「kill -s SIGTERM 1234」**である
  - 3-12の問題を参照する
    - killコマンドを明示的にシグナルを指定しない場合は、**SIGTERM(15)**が送信される
    - -sオプションは、シグナルを送信するオプションで省略可能

### 3-14
- [Ctrl] + [c]で送信されるシグナル番号として適切なものは、**SIGINT(2)**である
  - 3-12の問題を参照する
    - [Ctrl] + [z]が押された場合は、**SIGTSTP(20)**が送信される

### 3-15
- あるプロセスのPIDが1023のとき、このプロセスを終了させたいが、終了時にそのプロセスによるクリーンアップ(終了処理)を実行させる際のコマンドラインとして適切なものは、**kill -15 1023**または、**kill -SIGTERM 1023**である
  - 3-12の問題を参照する
    - クリーンアップ
      - 使っていたリソースの開放やロックファイルの削除などを行う
      - SIGTERM(15)でプロセスが終了しないような、やむを得ない場合は**SIGKILL(9)**を使用して強制終了する

### 3-16
- SIGUSR1シグナルをapache2という名前のプロセスに送信させる際のコマンドラインとして適切なものは、**killall -SIGUSR1 apache2**である
  - killallコマンド
    - 同じ名前のプロセスが複数存在し、それらをまとめて終了したい場合に利用する
    - また、killallコマンドと同様の処理を行う**pkill**コマンドや、プロセス名から現在実行中のプロセスを検索する**pgrep**コマンドも提供される
    - コマンドの構文
      - killall [オプション] [シグナル名 | シグナル番号] プロセス名

  - pkillコマンド
    - プロセスを指定して、終了シグナル(TERMシグナル)などの「シグナル」を送信するコマンドである
    - killallコマンドと違い、pkillコマンドの場合は対象とするプロセス名を正規表現で指定する
      - 例えば、「**pkill abc**」の場合は、「名前にabcを含むすべてのプロセス」が対象になる
    - コマンドの構文
      - pkill [オプション] [プロセス名などのパターン]
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -(--signal) シグナル | 送信するシグナルを番号またはシグナル名で指定する |
      | -e(--echo) | 対象となったプロセスとプロセスIDを表示する |
      | -c(--count) | 該当するプロセス（シグナルを送ったプロセス）の個数を表示する |

  - pgrepコマンド
    - 現在実行中のプロセスを調べてユーザー名、UID、GIDなどを基にプロセスIDを検索する
    - コマンドの構文
      - pgrep [オプション] [パターン]
    - 主なオプション
      | オプション | 説明 |
      | ---- | ---- |
      | -t 端末 | 指定した端末で実行されているプロセスIDを検索する。「.」区切りで複数指定可能 |
      | -u euid | 指定された実行ユーザーIDに該当するプロセスIDを検索する。ユーザーは名前またはIDで指定し、「,」区切りで複数指定可能 |
      | -U uid | 指定された実ユーザーIDに該当するプロセスIDを検索する。ユーザーは名前またはIDで指定し、「,」区切りで複数指定可能 |

### 3-17
- jobsコマンドを実行すると以下のように表示される
  ```
  $ jobs
  [1] Running prog &
  [2] - Running search &
  [3] + Running top &
  ```
  上記のジョブのうち、topジョブを終了させるコマンドラインとして適切なものは、**kill %3**である
  - 3-12の問題を参照する
  - コマンドの構文
    - kill [オプション] [シグナル名 | シグナル番号] %ジョブID

### 3-18
- 特定のコマンドを秒数を指定し繰り返し実行させて、結果を端末に表示するコマンドは、**watch**である
  - watchコマンド
    - 指定されたコマンドを繰り返し実行し、その結果を表示する
    - プログラムの出力の経時変化を監視できる
    - デフォルトでは2秒おきに実行されるが、時間の間隔を変えたい場合は-nまたは--intervalを指定する
    - watchコマンドは中断([Ctrl] + [c])されるまで実行を続ける

### 3-19
- tmuxコマンドの説明で誤っているものは、**GUI端末の画面制御プログラム**である
  - tmux
    - 1つの物理的な端末画面から多数の端末を作成、アクセス、および制御することができる文字型端末の画面制御プログラムである
    - 1つの画面の中で複数の画面を起動して作業可能
    - sshによるリモートログイン時でも同様に利用可能
    - tmuxで使用される用語
      | 用語 | 説明 |
      | ---- | ---- |
      | セッション | tmuxの管理下にある仮想端末の単一の集合 |
      | ウインドウ | セッション内で管理される仮想ウインドウ |
      | デタッチ | セッションから切断 |
      | アタッチ | デタッチしたセッションに再接続 |
    - tmuxと同様の機能を提供するものとして「screen」コマンドもある
