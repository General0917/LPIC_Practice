# 9-1 システムクロックの設定

## システムクロックとハードウェアクロック
- ハードウェアクロック
  - コンピュータに内蔵された時計
  - 電源を切っても動作する
- システムクロック
  - Linuxが使用する時計
    - 起動時に、ハードウェアクロックから設定
    - 起動後、ハードウェアクロックとは独立して動作
  - 起動してから長い時間が経過すると、ハードウェアクロックとシステムクロックで時差が出る

## dateコマンド
- システムクロックを参照する
- dateコマンドの書式
  - date 書式
    | 書式 | 説明 |
    | ---- | ---- |
    | %Y | 年 |
    | %m | 月(01~12) |
    | %d | 日(0~31) |
    | %H | 時(00~23) |
    | %M | 分(00~59) |
    | %a | 曜日(Sun~Sat) |
    | %b | 月(Jan~Dec) |
  - 年/月/日(曜日)形式で、システムクロックを表示する
    ```
    [root@centos7 ~]# date "+%Y/%m/%d(%a)"
    2023/10/27(Fri)
    ```
  - スーパユーザはシステムクロックを変更できる
    - date [MMDDhhmm[[CC]YY][.ss]]
    - システムクロックを2012年11月30日17時15分に設定する
      ```
      [root@centos7 ~]# date 113017152012
      ```

## hwclockコマンド
- ハードウェアクロックの参照/設定を行う
- hwclockコマンドの書式
  - hwclockオプション
    | オプション | 説明 |
    | ---- | ---- |
    | -r | ハードウェアクロックを表示する(デフォルト) |
    | -w(--systohc) | システムクロックの時刻を、ハードウェアクロックに同期する |
    | -s(--hctosys) | ハードウェアクロックの時刻を、システムクロックに同期する |
  - ハードウェアクロックの時刻を、システムクロックに同期する
    ```
    [root@centos7 ~]# hwclock -s
    ```

## NTP(Network Time Protocol)
- タイムサーバ(NTPサーバ)から、正確な時刻を同期するプロトコル
  - NTPで時刻合わせを行える機器には、パソコンやサーバーといったコンピュータの他にもスマートフォンや、ルーターなどのさまざまな情報機器、家電製品など多種多様なものがある
  
## ntpdateコマンド
- NTPサーバから時刻を取得する
- ntpdateコマンドの書式
  - ntpdate NTPサーバホスト名
  - NTPサーバtime.ai-plus.comから時刻を取得する
    ```
    [root@centos7 ~]# ntpdate time.ai-plus.com
    ```

## NTPサーバの設定
- LinuxをNTPサーバにすることもできる
  - 社内にNTPクライアントが多数存在する場合など
  - ntpdを起動すると、NTPサーバになる
    ```
    [root@centos7 ~]# /etc/init.d/ntpd start
    ```
  - NTPサーバの設定は、/etc/ntp.confで行う
    ```
    [root@centos7 ~]# cat /etc/ntp.conf
    # /etc/ntp.conf, configuration for ntpd; see ntp.conf(5) for help

    driftfile /var/lib/ntp/ntp.drift

    # Leap seconds definition provided by tzdata
    leapfile /usr/share/zoneinfo/leap-seconds.list

    # Enable this if you want statistics to be logged.
    #statsdir /var/log/ntpstats/

    statistics loopstats peerstats clockstats
    filegen loopstats file loopstats type day enable
    filegen peerstats file peerstats type day enable
    filegen clockstats file clockstats type day enable

    # Specify one or more NTP servers.

    # Use servers from the NTP Pool Project. Approved by Ubuntu Technical Board
    # on 2011-02-08 (LP: #104525). See http://www.pool.ntp.org/join.html for
    # more information.
    pool 0.ubuntu.pool.ntp.org iburst
    pool 1.ubuntu.pool.ntp.org iburst
    pool 2.ubuntu.pool.ntp.org iburst
    pool 3.ubuntu.pool.ntp.org iburst

    # Use Ubuntu's ntp server as a fallback.
    pool ntp.ubuntu.com
    (以下省略)
    ```

# 9-2 システムログの設定
- 

