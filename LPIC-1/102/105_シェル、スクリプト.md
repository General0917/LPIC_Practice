## シェル変数
- シェル変数は、現在実行中のシェルのみ有効
  - `変数名=値`で、シェル変数に値を代入
  - `echo $変数名`で、シェル変数の値を表示
    - `echo 文字列`で、文字列を表示
  - `unset 変数名`で、シェル変数を削除

## 環境変数
- 環境変数は、シェルから実行したプロセスでも有効
  - 基本的な使い方は、シェル変数と同じ
  - `export 変数名`で、シェル変数が環境変数になる

## envコマンド(printenvコマンド)
- 環境変数とその値を表示
  ```
  [root@centos7 ~]# env
    XDG_SESSION_ID=1
    HOSTNAME=centos7
    SHELL=/bin/bash
    TERM=xterm-256color
    HISTSIZE=1000
    USER=root
    (以下省略)
  ```

## setコマンド
- シェル変数、環境変数とその値を表示
  ```
  [root@centos7 ~]# set
    BASH=/bin/bash
    BASHOPTS=checkwinsize:cmdhist:expand_aliases:extquote:force_fignore:histappend:hostcomplete:interactive_comments:login_shell:progcomp:promptvars:sourcepath
    BASH_ALIASES=()
    BASH_ARGC=()
    BASH_ARGV=()
    BASH_CMDS=()
    BASH_LINENO=()
    BASH_SOURCE=()
    BASH_VERSINFO=([0]="4" [1]="2" [2]="46" [3]="2" [4]="release" [5]="x86_64-redhat-linux-gnu")
    BASH_VERSION='4.2.46(2)-release'
    COLUMNS=124
    DIRSTACK=()
    (以下省略)
  ```

- シェルのオプションを変更する
  - `-o`で有効化、`+o`で無効化
  - -noglobオプションを有効化する
    - `*.h`を、.hで終わるファイル名ではなく、`*.h`というファイル名と解釈する
      ```
      [root@centos7 ~]# set -o noglob
      ```
    - 設定されているオプションを表示する
      ```
      [root@centos7 ~]# set -o
      allexport       off
      braceexpand     on
      emacs           on
      errexit         off
      (以下省略)
      ```

- setコマンドの書式
  - set [-o | +o] [オプション]
    | コマンド | 説明 |
    | ---- | ---- |
    | allexport | 作成、変更した変数を自動的にエクスポートする |
    | emacs | emacs風のキーを割り当てにする |
    | ignoreeof | Ctrl+Dでログアウトしないようにする |
    | noclobber | 出力をリダイレクトする |
    | noglob | メタキャラクタを使ったファイル名を展開する |
    | vi | vi風のキーを割り当てる |

## エイリアス
- コマンドに別名を付ける機能
  - コマンドとオプションをまとめて、簡単に呼び出せる
  - `alias`コマンドを作成
    ```
    [root@centos7 ~]# alias lsal='ls -al'
    [root@centos7 ~]# alias lsal='ls -al'
    [root@centos7 ~]# lsal
    total 8772
    drwx------.  5 root    root       4096 Sep 22 04:55 .
    dr-xr-xr-x. 18 root    root        236 May  6  2019 ..
    -rw-------   1 penguin penguin    4060 Oct  7 05:02 .bash_history
    -rw-r--r--.  1 penguin penguin      18 Dec  5  2018 .bash_logout
    -rw-r--r--.  1 penguin penguin     176 Dec  5  2018 .bash_profile
    -rw-r--r--.  1 penguin penguin     124 Dec  5  2018 .bashrc
    (以下省略)
    ```
  - `unalias`コマンドで解除
    ```
    [root@centos7 ~]# unalias lsal
    [root@centos7 ~]# lsal
    -bash: lsal: command not found
    ```
  - コマンドの前に`\`を付けると、エイリアス設定を無視してコマンド実行
    ```
    [root@centos7 ~]# \ls
    backup.cpio  diary.txt        htop-2.2.0-3.el7.x86_64.rpm           rose.txt  xab
    data         file_management  httpd-2.4.6-89.el7.centos.x86_64.rpm  xaa
    ```

## 関数
- 複数のコマンドを組み合わせて、一括して呼び出す機能
  - `function`コマンドで作成
    ```
    [root@centos7 ~]# function lsless() { ls -al | less; }
    ```
  - 関数名を入力して、実行
    - コマンドモードで開かれるので、閉じたい場合は、`q`で閉じる
    ```
    [root@centos7 ~]# lsless
    total 8772
    drwx------.  5 root    root       4096 Sep 22 04:55 .
    dr-xr-xr-x. 18 root    root        236 May  6  2019 ..
    -rw-------   1 penguin penguin    4060 Oct  7 05:02 .bash_history
    -rw-r--r--.  1 penguin penguin      18 Dec  5  2018 .bash_logout
    -rw-r--r--.  1 penguin penguin     176 Dec  5  2018 .bash_profile
    -rw-r--r--.  1 penguin penguin     124 Dec  5  2018 .bashrc
    (以下省略)
    ```
  - `declare -f`コマンドで、定義された関数を表示
    ```
    [root@centos7 ~]# declare -f
    lsless ()
    {
        ls --color=auto -al | less
    }
    ```
  - `unset`コマンドで削除
    ```
    [root@centos7 ~]# unset lsless
    [root@centos7 ~]# declare -f
    [root@centos7 ~]# lsless
    -bash: lsless: command not found
    ```

## bashの設定ファイル
- シェルを起動した際に、自動的に起動されるシェルスクリプト
  - 環境変数やエイリアスを自動的に設定するなど
    | ファイル | 説明 |
    | ---- | ---- |
    | /etc/profile | ログイン時に実行され、全ユーザから参照される |
    | ~/.bash_profile | ログイン時に実行される |
    | ~/.bash_login | ~/.bash_profileがない場合、ログイン時に実行される |
    | ~/.profile | ~/.bash_profileも~/.bash_loginもない場合、ログイン時に実行される |
    | ~/.bashrc | bash起動時に実行される |
    | ~/.bash_logout | ログアウト時に実行される |

## シェルスクリプトの基礎
- テキストファイルにコマンドを並べたもの
  - 処理を一括して実行するために作成
    ```
    [root@centos7 ~]# cat initalias.sh
    alias rm='rm -i'
    alias cp='cp -i'
    alias mv='mv -i'
    ```
  - sourceコマンドで実行(省略型は、`.`)
    ```
    [root@centos7 ~]# source initalias.sh
    [root@centos7 ~]# . initalias.sh
    ```
  - 実行(x)権を与えれば、ファイル名だけで実行
    ```
    [root@centos7 ~]# ./initalias.sh
    ```

## スクリプトに渡す引数
- 一般のコマンドと同様、シェルスクリプトに引数を指定することもできる
  | ファイル | 説明 |
  | ---- | ---- |
  | $0 | シェルスクリプトファイル名 |
  | $1 | 1つ目の引数 |
  | $2 | 2つ目の引数。以下は、$3, $4 ... $n |
  | $# | 引数の数 |
  | $@ | 全ての引数(スペース区切り) |
  | $* | 全ての引数(区切りは環境変数IFSで指定) |

## 戻り値
- コマンドの実行結果を表す値
  - 正常終了は`0`
  - 異常終了は`0`以外
- 変数`$?`に格納されている
  ```
  [root@centos7 ~]# echo $?
  0
  [root@centos7 ~]# ls -l init
  ls: cannot access init: No such file or directory
  [root@centos7 ~]# echo $?
  2
  ```

## testコマンド
- 